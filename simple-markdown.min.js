!function(){function r(n){return n.replace(b,"\n").replace(k,"").replace(_,"    ")}function i(n,t){var e=n||{};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function n(m,e){var g,y=Object.keys(m).filter(function(n){var t=m[n];if(null==t||null==t.match)return!1;var e=t.order;return"number"==typeof e&&isFinite(e)||"undefined"==typeof console||console.warn("simple-markdown: Invalid order for rule `"+n+"`: "+String(e)),!0});y.sort(function(n,t){var e=m[n],r=m[t],l=e.order,o=r.order;if(l!==o)return l-o;var u=e.quality?0:1,a=r.quality?0:1;return u!=a?u-a:n<t?-1:t<n?1:0});var v=function(n,t){var e=[];g=t=t||g;for(var r="";n;){var l=null,o=null,u=null,a=NaN,i=0,c=y[0],s=m[c];do{var f=s.order,p=s.match(n,t,r);if(p){var d=s.quality?s.quality(p,t,r):0;d<=a||(l=c,o=s,u=p,a=d)}c=y[++i],s=m[c]}while(s&&(!u||s.order===f&&s.quality));if(!0!==t.disableErrorGuards){if(null==o||null==u)throw new Error("Could not find a matching rule for the below content. The rule with highest `order` should always match content provided to it. Check the definition of `match` for '"+y[y.length-1]+"'. It seems to not match the following source:\n"+n);if(0!==u.index&&n.slice(0,u[0].length)!==u[0])throw new Error("`match` must return a capture starting at index 0 (the current parse index). Did you forget a ^ at the start of the RegExp?")}var h=o.parse(u,v,t);Array.isArray(h)?Array.prototype.push.apply(e,h):(null==h.type&&(h.type=l),e.push(h)),r=u[0],n=n.substring(r.length)}return e};return function(n,t){return(g=i(t,e)).inline||g.disableAutoBlockNewlines||(n+="\n\n"),v(r(n),g)}}function t(e){function n(n,t){return t.inline?e.exec(n):null}return n.regex=e,n}function e(e){function n(n,t){return t.inline?null:e.exec(n)}return n.regex=e,n}function l(e){function n(n,t){return e.exec(n)}return n.regex=e,n}function u(n,t,e,r,l){e=e||{},r=void 0===r||r,!0===(l=void 0!==l?l:0)&&(l=1);var o="";for(var u in e){var a=e[u];Object.prototype.hasOwnProperty.call(e,u)&&a&&(o+=" "+p(u)+'="'+p(a)+'"')}var i="<"+n+o+">";return r&&(i+=t+"</"+n+">"),l&&(i+="\n".repeat(l)),i}function o(n){if(null==n)return null;try{var t=decodeURIComponent(n).replace(/[^A-Za-z0-9/:]/g,"").toLowerCase();if(0===t.indexOf("javascript:")||0===t.indexOf("vbscript:")||0===t.indexOf("data:"))return null}catch(n){return null}return n}function a(n){return n.replace(R,"$1")}function c(n,t,e){var r=e.inline||!1;e.inline=!0;var l=n(t,e);return e.inline=r,l}function s(n,t,e){return{content:c(t,n[1],e)}}function f(){return{}}function p(n){return String(n).replace(S,function(n){return E[n]})}var d,h,m,g,y,v,x,w,b=/\r\n?/g,_=/\t/g,k=/\f/g,S=/[<>&]/g,E={"<":"&lt;",">":"&gt;","&":"&amp;","/":"&#x2F;","`":"&#96;"},R=/\\([^0-9A-Za-z\s])/g,A="(?:[*+-]|\\d+\\.)",$="( *)("+A+") +",O=new RegExp("^"+$),P=new RegExp($+"[^\\n]*(?:\\n(?!\\1"+A+" )[^\\n]*)*(\n|$)","gm"),j=/\n{2,}$/,T=j,q=/ *\n+$/,F=new RegExp("^( *)("+A+") [\\s\\S]+?(?:\n{2,}(?! )(?!\\1"+A+" )\\n*|\\s*\n*$)"),B=/(?:^|\n)( *)$/,C=(d=/^ *| *\| *$/g,h=/\n+$/,m=/^ *\| *| *\| *$/g,g=/^ *| *$/g,y=/ *\| */,v=/^ *-+: *$/,x=/^ *:-+: *$/,w=/^ *:-+ *$/,{parseTable:function(n,t,e){e.inline=!0;var r,l,o=N(d,n,t,e),u=z(d,n),a=(r=t,l=e,n[3].replace(h,"").split("\n").map(function(n){return n.replace(m,"").split(y).map(function(n){return r(n,l)})}));return e.inline=!1,{type:"table",header:o,align:u,cells:a}},parseNpTable:function(n,t,e){e.inline=!0;var r,l,o=N(g,n,t,e),u=z(g,n),a=(r=t,l=e,n[3].replace(h,"").split("\n").map(function(n){return n.split(y).map(function(n){return r(n,l)})}));return e.inline=!1,{type:"table",header:o,align:u,cells:a}},NPTABLE_REGEX:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/});function I(n){return v.test(n)?"right":x.test(n)?"center":w.test(n)?"left":null}function N(n,t,e,r){return t[1].replace(n,"").split(y).map(function(n){return e(n,r)})}function z(n,t){return t[2].replace(n,"").split(y).map(I)}function L(n,t,e){var r=(n[2]||n[1]).replace(/\s+/g," ").toLowerCase();if(t._defs&&t._defs[r]){var l=t._defs[r];e.target=l.target,e.title=l.title}return t._refs=t._refs||{},t._refs[r]=t._refs[r]||[],t._refs[r].push(e),e}function Z(e,r,l){if(!r)throw new Error("simple-markdown: outputFor: `property` must be defined. if you just upgraded, you probably need to replace `outputFor` with `htmlFor`");var o,u=e.Array||Q.Array,a=function(n,t){return o=t=t||o,Array.isArray(n)?u[r](n,a,t):e[n.type][r](n,a,t)};return function(n,t){return o=i(t,l),a(n,o)}}function G(n,t){return(t=t||{}).inline=!1,J(n,t)}function U(n,t){var e=j.test(n);return(t=t||{}).inline=!e,J(n,t)}var H="(?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*",M="\\s*<?((?:[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*",X=/mailto:/i,D=0,Q={Array:{html:function(n,t,e){for(var r="",l=0;l<n.length;l++){var o=n[l];if("text"===o.type)for(o={type:"text",content:o.content};l+1<n.length&&"text"===n[l+1].type;l++)o.content+=n[l+1].content;r+=t(o,e)}return r}},heading:{order:D++,match:e(/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n *)+\n/),parse:function(n,t,e){return{level:n[1].length,content:c(t,n[2],e)}},html:function(n,t,e){return u("h"+n.level,t(n.content,e),null,!0,2)}},nptable:{order:D++,match:e(C.NPTABLE_REGEX),parse:C.parseNpTable,html:null},lheading:{order:D++,match:e(/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/),parse:function(n,t,e){return{type:"heading",level:"="===n[2]?1:2,content:c(t,n[1],e)}},html:null},hr:{order:D++,match:e(/^( *[-*_]){3,} *(?:\n *)+\n/),parse:f,html:function(n,t,e){return"<hr>"}},codeBlock:{order:D++,match:e(/^(?: {4}[^\n]+\n*)+(?:\n *)+\n/),parse:function(n,t,e){return{lang:void 0,content:n[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}},html:function(n,t,e){var r=n.lang?"code-"+n.lang:void 0;return u("pre",u("code",p(n.content),{class:r}),null,!0,2)}},fence:{order:D++,match:e(/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n *)+\n/),parse:function(n,t,e){return{type:"codeBlock",lang:n[2]||void 0,content:n[3]}},html:null},blockQuote:{order:D++,match:e(/^( *>[^\n]+(\n[^\n]+)*\n*)+\n{2,}/),parse:function(n,t,e){return{content:t(n[0].replace(/^ *> ?/gm,""),e)}},html:function(n,t,e){return u("blockquote",t(n.content,e))}},list:{order:D++,match:function(n,t,e){var r=B.exec(e),l=t._list||!t.inline;return r&&l?(n=r[1]+n,F.exec(n)):null},parse:function(n,f,p){var t=n[2],e=1<t.length,r=e?+t:void 0,d=n[0].replace(T,"\n").match(P),h=!1;return{ordered:e,start:r,items:d.map(function(n,t){var e=O.exec(n)[0].length,r=new RegExp("^ {1,"+e+"}","gm"),l=n.replace(r,"").replace(O,""),o=t===d.length-1,u=-1!==l.indexOf("\n\n")||o&&h;h=u;var a,i=p.inline,c=p._list;p._list=!0,a=u?(p.inline=!1,l.replace(q,"\n\n")):(p.inline=!0,l.replace(q,""));var s=f(a,p);return p.inline=i,p._list=c,s})}},html:function(n,t,e){var r="\n"+n.items.map(function(n){return"  "+u("li",t(n,e))}).join("\n")+"\n";return u(n.ordered?"ol":"ul",r,{start:n.start},!0,2)}},def:{order:D++,match:e(/^ *\[([^\]]+)\]: *<?([^\s>]*)>?(?: +["(]([^\n]+)[")])? *\n(?: *\n)*/),parse:function(n,t,e){var r=n[1].replace(/\s+/g," ").toLowerCase(),l=n[2],o=n[3];return e._refs&&e._refs[r]&&e._refs[r].forEach(function(n){n.target=l,n.title=o}),e._defs=e._defs||{},e._defs[r]={target:l,title:o},{def:r,target:l,title:o}},html:function(){return""}},table:{order:D++,match:e(/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/),parse:C.parseTable,html:function(t,e,r){function l(n){return null==t.align[n]?"":"text-align:"+t.align[n]+";"}var n=t.header.map(function(n,t){return u("th",e(n,r),{style:l(t),scope:"col"})}).join(""),o=t.cells.map(function(n){return u("tr",n.map(function(n,t){return u("td",e(n,r),{style:l(t)})}).join(""))}).join("");return u("table",u("thead",u("tr",n))+u("tbody",o))}},newline:{order:D++,match:e(/^(?:\n *)*\n/),parse:f,html:function(n,t,e){return"\n"}},paragraph:{order:D++,match:e(/^((?:[^\n]|\n(?! *\n))+)(?:\n *)+\n/),parse:s,html:function(n,t,e){return u("p",t(n.content,e),null,!0,2)}},escape:{order:D++,match:t(/^\\([^0-9A-Za-z\s])/),parse:function(n,t,e){return{type:"text",content:n[1]}},html:null},autolink:{order:D++,match:t(/^<([^ >]+:\/[^ >]+)>/),parse:function(n,t,e){return{type:"link",content:[{type:"text",content:n[1]}],target:n[1]}},html:null},mailto:{order:D++,match:t(/^<([^ >]+@[^ >]+)>/),parse:function(n,t,e){var r=n[1],l=n[1];return X.test(l)||(l="mailto:"+l),{type:"link",content:[{type:"text",content:r}],target:l}},html:null},url:{order:D++,match:t(/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/),parse:function(n,t,e){return{type:"link",content:[{type:"text",content:n[1]}],target:n[1],title:void 0}},html:null},link:{order:D++,match:t(new RegExp("^\\[("+H+")\\]\\("+M+"\\)")),parse:function(n,t,e){return{content:t(n[1],e),target:a(n[2]),title:n[3]}},html:function(n,t,e){var r={href:o(n.target),title:n.title};return u("a",t(n.content,e),r)}},image:{order:D++,match:t(new RegExp("^!\\[("+H+")\\]\\("+M+"\\)")),parse:function(n,t,e){return{alt:n[1],target:a(n[2]),title:n[3]}},html:function(n,t,e){return u("img","",{src:o(n.target),alt:n.alt,title:n.title},!1)}},reflink:{order:D++,match:t(new RegExp("^\\[("+H+")\\]\\s*\\[([^\\]]*)\\]")),parse:function(n,t,e){return L(n,e,{type:"link",content:t(n[1],e)})},html:null},refimage:{order:D++,match:t(new RegExp("^!\\[("+H+")\\]\\s*\\[([^\\]]*)\\]")),parse:function(n,t,e){return L(n,e,{type:"image",alt:n[1]})},html:null},em:{order:D,match:t(new RegExp("^\\b_((?:__|\\\\[\\s\\S]|[^\\\\_])+?)_\\b|^\\*(?=\\S)((?:\\*\\*|\\\\[\\s\\S]|\\s+(?:\\\\[\\s\\S]|[^\\s\\*\\\\]|\\*\\*)|[^\\s\\*\\\\])+?)\\*(?!\\*)")),quality:function(n){return n[0].length+.2},parse:function(n,t,e){return{content:t(n[2]||n[1],e)}},html:function(n,t,e){return u("em",t(n.content,e))}},strong:{order:D,match:t(/^\*\*((?:\\[\s\S]|[^\\])+?)\*\*(?!\*)/),quality:function(n){return n[0].length+.1},parse:s,html:function(n,t,e){return u("strong",t(n.content,e))}},u:{order:D++,match:t(/^__((?:\\[\s\S]|[^\\])+?)__(?!_)/),quality:function(n){return n[0].length},parse:s,html:function(n,t,e){return u("u",t(n.content,e))}},del:{order:D++,match:t(/^~~(?=\S)((?:\\[\s\S]|~(?!~)|[^\s\\~]|\s+(?!~~))+?)~~/),parse:s,html:function(n,t,e){return u("del",t(n.content,e))}},inlineCode:{order:D++,match:t(/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/),parse:function(n,t,e){return{content:n[2]}},html:function(n,t,e){return u("code",p(n.content))}},br:{order:D++,match:l(/^ {2,}\n/),parse:f,html:function(n,t,e){return"<br>"}},moustache:{order:D++,match:l(/{{([\s\S]*?)}}/g),parse:function(n,t,e){return{content:"="===n[1][0]?n[0]:n[1]}},html:function(n,t,e){return n.content}},text:{order:D++,match:l(/^[\s\S]+?(?=[^0-9A-Za-z\s\u00c0-\uffff]|\n\n| {2,}\n|\w+:\S|$)/),parse:function(n,t,e){return{content:n[0]}},html:function(n,t,e){return p(n.content)}}},J=n(Q),K=Z(Q,"html"),V={defaultRules:Q,parserFor:n,outputFor:Z,inlineRegex:t,blockRegex:e,anyScopeRegex:l,parseInline:c,parseBlock:function(n,t,e){var r=e.inline||!1;e.inline=!1;var l=n(t+"\n\n",e);return e.inline=r,l},markdownToHtml:function(n,t){return K(G(n,t),t)},defaultBlockParse:G,defaultInlineParse:function(n,t){return(t=t||{}).inline=!0,J(n,t)},defaultImplicitParse:U,defaultHtmlOutput:K,preprocess:r,sanitizeText:p,sanitizeUrl:o,unescapeUrl:a,htmlTag:u,defaultRawParse:J,ruleOutput:function(r,l){return l||"undefined"==typeof console||console.warn("simple-markdown ruleOutput should take 'html' as the second argument."),function(n,t,e){return r[n.type][l](n,t,e)}},htmlFor:function(e){var r=function(n,t){return t=t||{},Array.isArray(n)?n.map(function(n){return r(n,t)}).join(""):e(n,r,t)};return r},defaultParse:function(){return"undefined"!=typeof console&&console.warn("defaultParse is deprecated, please use `defaultImplicitParse`"),U.apply(null,arguments)}};"undefined"!=typeof module&&module.exports?module.exports=V:"undefined"!=typeof global?global.SimpleMarkdown=V:window.SimpleMarkdown=V}();